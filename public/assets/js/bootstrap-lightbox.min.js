/*!=========================================================
* bootstrap-lightbox v0.4.1 - 11/20/2012
* http://jbutz.github.com/bootstrap-lightbox/
* HEAVILY based off bootstrap-modal.js
* ==========================================================
* Copyright (c) 2012 Jason Butz (http://jasonbutz.info)
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* ========================================================= */
!function(t){"use strict";var e=function(e,i){this.options=i,this.$element=t(e).delegate('[data-dismiss="lightbox"]',"click.dismiss.lightbox",t.proxy(this.hide,this)),this.options.remote&&this.$element.find(".lightbox-body").load(this.options.remote),this.cloneSize()};e.prototype={constructor:e,toggle:function(){return this[this.isShown?"hide":"show"]()},show:function(){var e=this,i=t.Event("show");this.$element.trigger(i),this.isShown||i.isDefaultPrevented()||(this.isShown=!0,this.escape(),this.backdrop(function(){var i=t.support.transition&&e.$element.hasClass("fade");e.$element.parent().length||e.$element.appendTo(document.body),e.$element.show(),i&&e.$element[0].offsetWidth,e.$element.addClass("in").attr("aria-hidden",!1),e.enforceFocus(),i?e.$element.one(t.support.transition.end,function(){e.centerImage(),e.$element.focus().trigger("shown")}):function(){e.centerImage(),e.$element.focus().trigger("shown")}()}))},hide:function(e){e&&e.preventDefault(),e=t.Event("hide"),this.$element.trigger(e),this.isShown&&!e.isDefaultPrevented()&&(this.isShown=!1,this.escape(),t(document).off("focusin.lightbox"),this.$element.removeClass("in").attr("aria-hidden",!0),t.support.transition&&this.$element.hasClass("fade")?this.hideWithTransition():this.hideLightbox())},enforceFocus:function(){var e=this;t(document).on("focusin.lightbox",function(t){e.$element[0]!==t.target&&!e.$element.has(t.target).length&&e.$element.focus()})},escape:function(){var t=this;this.isShown&&this.options.keyboard?this.$element.on("keyup.dismiss.lightbox",function(e){27==e.which&&t.hide()}):this.isShown||this.$element.off("keyup.dismiss.lightbox")},hideWithTransition:function(){var e=this,i=setTimeout(function(){e.$element.off(t.support.transition.end),e.hideLightbox()},500);this.$element.one(t.support.transition.end,function(){clearTimeout(i),e.hideLightbox()})},hideLightbox:function(){this.$element.hide().trigger("hidden"),this.backdrop()},removeBackdrop:function(){this.$backdrop.remove(),this.$backdrop=null},backdrop:function(e){var i=this.$element.hasClass("fade")?"fade":"";if(this.isShown&&this.options.backdrop){var n=t.support.transition&&i;this.$backdrop=t('<div class="modal-backdrop '+i+'" />').appendTo(document.body),this.$backdrop.click("static"==this.options.backdrop?t.proxy(this.$element[0].focus,this.$element[0]):t.proxy(this.hide,this)),n&&this.$backdrop[0].offsetWidth,this.$backdrop.addClass("in"),n?this.$backdrop.one(t.support.transition.end,e):e()}else!this.isShown&&this.$backdrop?(this.$backdrop.removeClass("in"),t.support.transition&&this.$element.hasClass("fade")?this.$backdrop.one(t.support.transition.end,t.proxy(this.removeBackdrop,this)):this.removeBackdrop()):e&&e()},centerImage:function(){var e,i=this,n=0;if(i.h=i.$element.height(),i.w=i.$element.width(),i.options.resizeToFit){n=10,e=i.$element.find(".lightbox-content").find("img:first"),e.data("osizew")||e.data("osizew",e.width()),e.data("osizeh")||e.data("osizeh",e.height()),e.data("osizew"),e.data("osizeh"),e.css("max-width","none"),e.css("max-height","none");var s=40;i.$element.find(".lightbox-header").length>0&&(s+=10),e.css("max-width",t(window).width()-s),e.css("max-height",t(window).height()-s),i.w=e.width(),i.h=e.height()}i.$element.css({position:"fixed",left:t(window).width()/2-i.w/2,top:t(window).height()/2-i.h/2-n}),i.enforceFocus()},cloneSize:function(){var e=this;e.$clone=e.$element.filter(":first").clone().css({position:"absolute",top:-2e3,display:"block",visibility:"visible",opacity:100}).removeClass("fade").appendTo("body"),e.h=e.$clone.height(),e.w=e.$clone.width(),e.$clone.remove(),e.$element.css({position:"fixed",left:t(window).width()/2-e.w/2,top:t(window).height()/2-e.h/2})}},t.fn.lightbox=function(i){return this.each(function(){var n=t(this),s=n.data("lightbox"),o=t.extend({},t.fn.lightbox.defaults,n.data(),"object"==typeof i&&i);s||n.data("lightbox",s=new e(this,o)),"string"==typeof i?s[i]():o.show&&s.show()})},t.fn.lightbox.defaults={backdrop:!0,keyboard:!0,show:!0,resizeToFit:!0},t.fn.lightbox.Constructor=e,t(document).on("click.lightbox.data-api",'[data-toggle="lightbox"]',function(e){var i=t(this),n=i.attr("href"),s=t(i.attr("data-target")||n&&n.replace(/.*(?=#[^\s]+$)/,"")),o=s.data("lightbox")?"toggle":t.extend({remote:!/#/.test(n)&&n},s.data(),i.data()),a=i.attr("data-image")||!1;e.preventDefault(),a&&(s.data("original-content",s.find(".lightbox-content").html()),s.find(".lightbox-content").html('<img border="0" src="'+a+'" />')),s.lightbox(o).one("hide",function(){i.focus()}).one("hidden",function(){a&&(s.find(".lightbox-content").html(s.data("original-content")),a=void 0)})})}(window.jQuery);